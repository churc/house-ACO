<!DOCTYPE html> 

<html> 

<head> 
    <meta charset="utf-8">
<!-------Edit the title of the page-------->
    <title>Your page title goes here</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-------Load CartoDB's code so we can pull in our CartoDB maps-------->
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/3.15/themes/css/cartodb.css">
 
<!-------if IE 8 link-------->
    <script src="http://libs.cartocdn.com/cartodb.js/v3/3.15/cartodb.js"></script> 
 <!-------load JQuery-------->
    <script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>   
<!------Switch between the different themes changing the stylesheet below - light-theme.css |dark-theme.css------>
    <link rel="stylesheet" href="css/light-theme.css">
    <link rel="stylesheet" href="css/makeitresponsive.css">
  
  
 <link rel="stylesheet" href="css/dblight-theme.css">
    <link rel="stylesheet" href="css/dbmakeitresponsive.css">  
  
  <style> 
        html, body {
        height: 100%; 
        margin: 0;
        padding: 0;  
        width: 100%;
        font-family: Courier;
      } 
 
      #map { 
        height: 100%; 
        width: 95%; 
        margin-left:15px;
        padding-top:10px;
      } 
    
     #map2 { 
        height: 50%; 
        width: 48%; 
       z-index:6;
      } 
    
     #map3 { 
        height: 50%; 
        width: 48%; 
        margin-left:0px;
       z-index:7;
      } 
    /* a [target="_blank‚Äù]{
        color: blue;   
        }*/
      
       .ACO-button { 
        position: inline; 
        position: absolute; 
        top: 470px; 
        left: 30px; 
        cursor: pointer; 
        font-size: 12.5px; 
        font-family: Courier; 
         line-height: 1.15;
        color: darkslategrey; 
         height: 65px; 
         width: 160px;     
         background-color: #EDEDED; 
         padding-top:8px;
         padding-right: 5px;
         padding-left: 12px;
        } 
       
        .ACO-picker {
        font-size: 11.5px; 
        font-family: Courier;
      
        }
      .ACO-picker:hover { 
       background: #E7EEFA;
        font-size: 11.5px; 
        font-family: Courier;
        } 
    
       .poverty-button{
        position: inline; 
        position: absolute; 
        top: 670px; 
        left: 30px; 
        cursor: pointer; 
        font-size: 12.5px; 
        font-family: Courier; 
         line-height: 1.15;
        color: darkslategrey; 
         height: 65px; 
         width: 160px;     
         background-color: #EDEDED; 
         padding-top:8px;
         padding-right: 5px;
         padding-left: 12px;
         z-index:1;
        }
    
        .poverty-picker {
        font-size: 11.5px; 
        font-family: Courier;
      }  
    
        .poverty-picker: hover {
        font-size: 11.5px; 
        font-family: Courier;
      }  
    
    .cartodb-popup-close-button {
        position: absolute;
        top: -12px;
        right: -11px;
        width: 26px;
        height: 26px;
        /* background: url('http://libs.cartodb.com/cartodb.js/v3/themes/img/light.png') no-repeat 0 -23px; */
        text-indent: -9999px;
        font-size: 0;
        line-height: 0;
        opacity: 1;
        text-transform: uppercase;
        z-index: 3;
      }
/*-----customize the infowindow CSS-----*/ 
     div.cartodb-popup.v2 div.cartodb-popup-content-wrapper {  
        opacity: 1; 
        color: darkslategrey; 
        margin-bottom: 1px; 
        margin-top:1px; 
        padding-top:1px; 
        padding-bottom:0px; 
        padding-left:7px; 
        padding-right:0px; 
        border-radius:0px; 
        max-width: 250px; 
      } 
  
      div.cartodb-popup p { 
        color: darkslategrey; 
        font-family: sans-serif; 
      } 
  
    
/*-----customize legend--------*/ 
      div.cartodb-legend-stack { 
        padding-bottom: 0px; 
        padding-right:0px; 
        margin-bottom:0px; 
        margin-right: 0px; 
        border-radius: 0px; 
        border-bottom:0px; 
        max-width:316px; 
        max-height:143px; 
        background: #EDEDED; 
        position: inline; 
        position: absolute; 
        top: 560px; 
        left: 30px;
      } 
    
        div.cartodb-legend-custom { 
        border-bottom:0px; 
        padding-bottom:0px; 
        margin-bottom:0px; 
        max-height:80%; 
      } 
       
        div.cartodb-legend-stack div.cartodb-legend { 
        border-bottom:0px;   
        margin-bottom:0px; 
        padding-bottom:0px; 
      } 
    
        div.cartodb-legend.custom ul li { 
        line-height:30px; 
      } 
   
      div.cartodb-legend.custom ul li .bullet { 
        margin-left:0px; 
        margin-top:10px; 
        margin-bottom:0px; 
      } 
       
      div.legend-title{ 
        margin-bottom:0px; 
        margin-right: 0px; 
        padding-bottom:0px; 
        padding-right: 0px; 
        border-bottom:0px; 
      } 
      div.cartodb-legend.bubble.ul{ 
        padding:0px; 
        margin:0px; 
        margin-bottom:2px; 
        text-align: left; 
      } 
        div.cartodb-legend.bubble{ 
        padding:4px 3px 1px 3px; 
        border-top:0px; 
        text-align: left; 
      } 
   
   </style> 
 
<script type="infowindow/html" id="infowindow_template">
<div class="cartodb-popup v2">
<a href="#close" class="cartodb-popup-close-button close">x</a>
  <div class="cartodb-popup-content-wrapper" style= "background: #FB623A">
    <div class="cartodb-popup-content">
       <h4></h4>
      <p>{{aco_num}}</p>
      <h4></h4>
      <p><strong>{{aco_name}}</strong></p>
      <h4></h4>
      <p>{{aco_serv_area}}</p>
      <h4>ACO Type</h4>
      <p>{{aco_agnt_type}}</p>
      <h4>Agreement Period Number</h4>
      <p>{{agmt_prd_num}}</p>
      <h4>Track 1</h4>
      <p>{{track_1}}</p>
      <h4>Track 2</h4>
      <p>{{track_2}}</p>
      <h4>Track 3</h4>
      <p>{{track_3}}</p>
      <h4>Start date</h4>
      <p>{{intl_strt_date}}</p>
    <h4></h4>
     <p><a href={{aco_public_reporting_website}}>ACO website</a></p>
      </div>
 </div>
 </div>    
  <div class="cartodb-popup-tip-container">
</div>
</script> 
<script> 
      var dataLayer;
//---------- Initialize map from CartoDB 
      $(document).ready(function () { 
        cartodb.createVis('map', 'https://thenewschool.cartodb.com/u/churc186/api/v2/viz/3441dc88-f84f-11e5-b332-0e5db1731f59/viz.json', {
             fullscreen: true , mobile_layout: true, maxZoom: 18, zoom: 4, center_lat: 39.8282, center_lon: -98.5795})
          .done(function (vis, layers) { 
    //--------layers[1] has ALL your data layers from /CartoDB and you access different //ones by changing /the number you give to getSubLayer(). you want /something like: //dataLayer=layers[1].getSubLayer(0); /dataLayer=layers[1].getSubLayer(1);  
         
        dataLayer = layers[1].getSubLayer(0); 
        dataLayer1 = layers[1].getSubLayer(1); 
         
          
//------ Tell CartoDB it's okay if there are embedded //videos and other files in our infowindow template - //note this goes in the done ()function directly after //the datalayers - as here
            dataLayer.infowindow.set('sanitizeTemplate', 'false');       
        // Tell CartoDB to use our template from above 
            dataLayer.infowindow.set('template',  $('#infowindow_template').html());     
          
           }); 

//-----Adding button to select: Initialize the button: add an event //handler to watch for clicks 
        $('.ACO-picker').change(function() { 
          
          if($(this).val()==='all') {
     var sql = "SELECT * FROM table_2016_mssp_acos_merge_participants_clean_count_2_merge";
  }
           else if($(this).val()==='1') {
    var sql = "SELECT * FROM table_2016_mssp_acos_merge_participants_clean_count_2_merge WHERE count =1";
  }
         else if($(this).val()==='2-5') {
    var sql = "SELECT * FROM table_2016_mssp_acos_merge_participants_clean_count_2_merge WHERE count >=2 AND count <5";
  }
  else if($(this).val()==='6-15') {
    var sql = "SELECT * FROM table_2016_mssp_acos_merge_participants_clean_count_2_merge WHERE count >=6 AND count <15";
  }
         else if($(this).val()==='16-50') {
    var sql = "SELECT * FROM table_2016_mssp_acos_merge_participants_clean_count_2_merge WHERE count >=16 AND count <50";
  }
  else if($(this).val()==='51-100') {
    var sql = "SELECT * FROM table_2016_mssp_acos_merge_participants_clean_count_2_merge WHERE count >=51 AND count <100";
  }
   else if($(this).val()==='101-200') {
    var sql = "SELECT * FROM table_2016_mssp_acos_merge_participants_clean_count_2_merge WHERE count >=101 AND count <200";
  }
  else if($(this).val()==='201-329') {
    var sql = "SELECT * FROM table_2016_mssp_acos_merge_participants_clean_count_2_merge WHERE count >=201 AND count <=328";
  } 
          dataLayer.setSQL(sql);
//----need to add -dataLayer1.setSQL(sql);- if you want function to work on sublayer1
        });  
         
      }); 
 </script>  

  
  
  <!----- this is new----->
 <script src="https://maps.googleapis.com/maps/api/js?sensor=false&v=3.8"></script>
 
 <!-- <script src="http://libs.cartocdn.com/cartodb.js/v3/cartodb.js"></script>--->

    <!--Change the URL's below in order to change the maps that are being shown.
        map1 is the one on the left side and map2 is the one on the right side.
        Go to your map view in CartoDB, click on share, and copy the URL under the API section
        Check the cartodb.js documentation for more info
        http://developers.cartodb.com/documentation/cartodb-js.html-->
    <script type="text/javascript">
      var map2,map3;
      var dataLayer;
        
    $(document).ready(function () { 
      cartodb.createVis('map2', 'https://thenewschool.cartodb.com/u/churc186/api/v2/viz/75dc5b88-031b-11e6-ab91-0ea31932ec1d/viz.json',
                       {mobile_layout: true, maxZoom:18, zoom:4, center_lat: 39.8282, center_lon: -98.5795 })
      .done(function(vis, layers) {
        map2 = vis.mapView.map;
        dataLayer = layers[1].getSubLayer(0); 
       dataLayer1 = layers[1].getSubLayer(1); 
      });
              
    $(document).ready(function () { 
        cartodb.createVis('map3', 'https://thenewschool.cartodb.com/u/churc186/api/v2/viz/9f6a6a1a-0327-11e6-94ff-0e787de82d45/viz.json',
                         {mobile_layout: true, maxZoom:18, zoom:4, center_lat: 39.8282, center_lon: -98.5795 })
        .done(function(vis, layers) {
        map3 = vis.mapView.map;
           map2.on('change:zoom change:center', function(e) {
             changeMapState(map2, map3);
           });
           map3.on('change:zoom change:center', function(e) {
            changeMapState(map3, map2);
          
         dataLayer = layers[1].getSubLayer(0); 
        dataLayer1 = layers[1].getSubLayer(1); 
           });     
        });
      })
    
 //-----Adding button to select: Initialize the button: add an event //handler to watch for clicks      
    $('.poverty-picker').change(function() { 
      var perc_below_povlevel_hc03 = $(this).val();
          var sql;
          if (perc_below_povlevel_hc03 === 'all') {
     sql = "SELECT * FROM churc186.acs_14_5yr_s1701_pov_clean_merge";
  }
        else if(perc_below_povlevel_hc03==='1-8.5') {
    sql = "SELECT * FROM churc186.acs_14_5yr_s1701_pov_clean_merge WHERE perc_below_povlevel_hc03 =>1 AND perc_below_povlevel_hc03 <8.5";
  }
         else if(perc_below_povlevel_hc03==='8.5-13.3') {
    sql = "SELECT * FROM churc186.acs_14_5yr_s1701_pov_clean_merge WHERE perc_below_povlevel_hc03 >=8.5 AND perc_below_povlevel_hc03 <13.3";
  }
  else if(perc_below_povlevel_hc03==='13.3-18.1') {
    sql = "SELECT * FROM churc186.acs_14_5yr_s1701_pov_clean_merge WHERE perc_below_povlevel_hc03 >=13.3 AND perc_below_povlevel_hc03 <18.1";
  }
         else if(perc_below_povlevel_hc03==='18.1-22.8') {
    sql = "SELECT * FROM churc186.acs_14_5yr_s1701_pov_clean_merge WHERE perc_below_povlevel_hc03 >=18.1 AND perc_below_povlevel_hc03 <22.8";
  }
  else if(perc_below_povlevel_hc03==='22.8-27.6') {
    sql = "SELECT * FROM churc186.acs_14_5yr_s1701_pov_clean_merge WHERE perc_below_povlevel_hc03 >=22.8 AND perc_below_povlevel_hc03 <27.6";
  }
   else if(perc_below_povlevel_hc03==='27.6-35.5') {
    sql = "SELECT * FROM churc186.acs_14_5yr_s1701_pov_clean_merge WHERE perc_below_povlevel_hc03 >=27.6 AND perc_below_povlevel_hc03 <35.5";
  }
  else if(perc_below_povlevel_hc03==='35.5-52.6') {
    sql = "SELECT * FROM churc186.acs_14_5yr_s1701_pov_clean_merge WHERE perc_below_povlevel_hc03 >=35.5 AND perc_below_povlevel_hc03 <=52.6";
  } 
          dataLayer.setSQL(sql);
        });
    });
      
//Applies the same view from src to tgt map
      function changeMapState(src,tgt){
        tgt.set({
           'center': src.get('center'),
           'zoom': src.get('zoom')
        });
      }
        
</script>  
</head>  
   
<body> 
    <div id="map"></div> 
    <div class="sidepanel">
      <div class="wrapper">
        <div class="context subheader">
          
          <p>Maps under development <a href="#"></a></p>
        </div>
        <h3>2016 Shared Savings Program Medicare Accountable Care Organization locations</h3>
        <p>Data is from The Centers for Medicare and Medicaid Services, CMS, part of the Department of Health and Human Services. <a href=''>https://data.cms.gov/ACO/2016-Medicare-Shared-Savings-Program-Accountable-C/i683-k66m</a> CMS notes that "The Medicare Shared Savings Program (or Shared Savings Program) facilitates coordination among providers to improve the quality of care for Medicare fee-for-service beneficiaries while reducing the growth in health care costs. Eligible providers, hospitals, and suppliers may apply to participate in the Shared Savings Program by creating or participating in an Accountable Care Organization (ACO)."</p>
<!--Copy and paste the div below for creating content blocks-->
        <h3>Description</h3>
        <p>In February 2016, there were 433 Accountable Care Organizations (ACOs) across the country. Each ACO brings several providers together to work with each other as a care team. The map shows each ACO location with ACO number and track (1, 2, or 3), and the next step is to link the providers each ACO is made up of. 
       </p>
        <h3>Sources</h3>
         <p>ACO providers <a href="#">link</a> are listed at  <a href="#">link</a>. The ACO vary in size from x number of providers to x providers. </p>
      </div>
    </div>
      
     <div class="ACO-button">
      <div>ACOs vary by number of participants from 1 to 328:</div> 
      <select class="ACO-picker"> 
        <option value='all'>All</option> 
        <option value='1'>1</option>       
        <option value='2-5'>2-5</option>
        <option value='6-15'>6-15</option> 
        <option value='16-50'>16-50</option> 
        <option value='51-100'>51-100</option> 
        <option value='101-200'>101-200</option> 
        <option value='201-329'>201-328</option> 
    </select></div> 
  
  
 <!-- this is NEW -->   

    <div class="row">
      <div class="col span2 empty"><p></p></div>
    <div class="col span2 empty"><p></p></div>
      <div class="col span2 empty"><p></p></div>
      <div class="col span16 context subheader">
        <!--Link to your personal website, your blog or your twitter account-->
        <p>The Medicare ACOs are mapped from CMS's ACO database which lists 433 ACOs, February 2016. <a href="#">{Link to CMS website}</a></p>
      </div>
      <div class="col span2 empty"><p></p></div>
    </div>
  
 <div class="col span8 map" id="map2"></div>
      <div class="col span8 map" id="map3"></div>
  
   <div class="poverty-button">
      <div>County poverty rates vary from 1% to 52.6%:</div> 
     <select class="poverty-picker"> 
        <option value='all'>All</option> 
        <option value='1-8.5'>1-8.5%</option>       
        <option value='8.5-13.3'>8.5-13.3%</option>
        <option value='13.3-18.1'>13.3-18.1%</option> 
        <option value='18.1-22.8'>18.1-22.8%</option> 
        <option value='22.8-27.6'>22.8-27.6%</option> 
        <option value='27.6-35.5'>27.6-35.5%</option> 
        <option value='35.5-52.6'>35.5-52.6%</option> 
    </select></div> 
   
   <!--  <div class="double">-->
       
<!-------second set of maps----->
  <div class="row">
      <div class="col span2 empty"><p></p></div>
    <div class="col span2 empty"><p></p></div>
      <div class="col span2 empty"><p></p></div>
      <div class="col span16 context subheader">
        <!--Link to your personal website, your blog or your twitter account-->
        <p>Vulnerability data at county level <a href="#">{Link to }</a></p>
      </div>
      <div class="col span2 empty"><p></p></div>
    </div>
  
 <div class="col span8 map" id="map2"></div>
      <div class="col span8 map" id="map3"></div>
  
  
    <!--In the paragraph below give an introduction to your visualization-->
    <div class="row">
      <div class="col span2 empty"><p></p></div>
      <div class="col span2 empty"><p></p></div>
      <div class="col span2 empty"><p></p></div>
      <div class="col span2 empty"><p></p></div>
      
      <div class="col span16">
        <h1 style="text-align: center;">County level poverty rates, high school graduate rates and disability rates in the United States</h1>
        <p>These maps detail in darker color areas of vulnerability where the poverty rate is higher and where the disability rate is higher.</p>
      </div>
      <div class="col span2 empty"><p></p></div>
   </div>
    
    <!--<div class="col span8 map" id="map4"></div>
      <div class="col span8 map" id="map5"></div>-->

    <!--Copy and paste the "row" div below a second, third, or fourth time to create content blocks-->
    <div class="row">
      <div class="col span2 empty"><p></p></div>
      <div class="col span12 titleBlock">
        <h3>Description block</h3>
      </div>
      <div class="col span2 empty"><p></p></div>
    </div>
    <div class="row">
      <div class="col span2 empty"><p></p></div>
      <div class="col span12">
        <p>Below is a map of the previous ACO locations overlaid with selected high poverty counties, those which have rates at ..% or higher. Counties with no Medicare ACO location which have high poverty rates are purple.
        The same has been done for ACO locations overlaid with selected low rate of people who graduated from high school graduate. The third set of maps does the same for ACO locations and disability rates with  ... % denoted as high rates.
        </p>
      </div>
      <div class="col span2 empty"><p></p></div>
    </div>

    <!--second content block-->
    <div class="row">
      <div class="col span2 empty"><p></p></div>
      <div class="col span12 titleBlock">
        <h3>Interactive map combining high vulnerability and no ACO location by county.</h3>
      </div>
      <div class="col span2 empty"><p></p></div>
    </div>
    <div class="row">
      <div class="col span2 empty"><p></p></div>
      <div class="col span12">
        <p>The map allows the viewer to filter by vulnerability<a href="#">data from US Census 2014 ACS</a> and to zoom into local areas to find ACO organizations and their provider sites.</p>
      </div>
      <div class="col span2 empty"><p></p></div>
    </div>
 
    <div style="padding-top:40px; text-align: center;"><h3>Description</h3>
        <p>2014 ACS 5 year data showing percent below the poverty level by county </p>
   
  </div>

<!--Play fair and keep the attributions. If you do so, we will love you even more. :)-->
    <div class="row">
      <div class="col span2 empty"><p></p></div>
      <div class="col span12 context footer">
        <p>Create your maps with ease using <a href="http://cartodb.com">CartoDB</a></p>
      </div>
      <div class="col span2 empty"><p></p></div>
    </div>
  </body> 
</html> 